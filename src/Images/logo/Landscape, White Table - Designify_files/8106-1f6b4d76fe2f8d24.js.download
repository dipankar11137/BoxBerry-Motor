(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8106],{27693:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,r="millisecond",i="second",a="minute",s="hour",o="day",c="week",l="month",u="quarter",d="year",h="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},v={s:m,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+m(r,2,"0")+":"+m(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,l),a=n-i<0,s=t.clone().add(r+(a?-1:1),l);return+(-(r+(n-i)/(a?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:l,y:d,w:c,d:o,D:h,h:s,m:a,s:i,ms:r,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",j={};j[b]=g;var w=function(e){return e instanceof S},y=function e(t,n,r){var i;if(!t)return b;if("string"==typeof t){var a=t.toLowerCase();j[a]&&(i=a),n&&(j[a]=n,i=a);var s=t.split("-");if(!i&&s.length>1)return e(s[0])}else{var o=t.name;j[o]=t,i=o}return!r&&i&&(b=i),i||!r&&b},k=function(e,t){if(w(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new S(n)},C=v;C.l=y,C.i=w,C.w=function(e,t){return k(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var S=function(){function g(e){this.$L=y(e.locale,null,!0),this.parse(e)}var m=g.prototype;return m.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(C.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(p);if(r){var i=r[2]-1||0,a=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},m.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},m.$utils=function(){return C},m.isValid=function(){return!(this.$d.toString()===f)},m.isSame=function(e,t){var n=k(e);return this.startOf(t)<=n&&n<=this.endOf(t)},m.isAfter=function(e,t){return k(e)<this.startOf(t)},m.isBefore=function(e,t){return this.endOf(t)<k(e)},m.$g=function(e,t,n){return C.u(e)?this[t]:this.set(n,e)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(e,t){var n=this,r=!!C.u(t)||t,u=C.p(e),f=function(e,t){var i=C.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?i:i.endOf(o)},p=function(e,t){return C.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},x=this.$W,g=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(u){case d:return r?f(1,0):f(31,11);case l:return r?f(1,g):f(0,g+1);case c:var b=this.$locale().weekStart||0,j=(x<b?x+7:x)-b;return f(r?m-j:m+(6-j),g);case o:case h:return p(v+"Hours",0);case s:return p(v+"Minutes",1);case a:return p(v+"Seconds",2);case i:return p(v+"Milliseconds",3);default:return this.clone()}},m.endOf=function(e){return this.startOf(e,!1)},m.$set=function(e,t){var n,c=C.p(e),u="set"+(this.$u?"UTC":""),f=(n={},n[o]=u+"Date",n[h]=u+"Date",n[l]=u+"Month",n[d]=u+"FullYear",n[s]=u+"Hours",n[a]=u+"Minutes",n[i]=u+"Seconds",n[r]=u+"Milliseconds",n)[c],p=c===o?this.$D+(t-this.$W):t;if(c===l||c===d){var x=this.clone().set(h,1);x.$d[f](p),x.init(),this.$d=x.set(h,Math.min(this.$D,x.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},m.set=function(e,t){return this.clone().$set(e,t)},m.get=function(e){return this[C.p(e)]()},m.add=function(r,u){var h,f=this;r=Number(r);var p=C.p(u),x=function(e){var t=k(f);return C.w(t.date(t.date()+Math.round(e*r)),f)};if(p===l)return this.set(l,this.$M+r);if(p===d)return this.set(d,this.$y+r);if(p===o)return x(1);if(p===c)return x(7);var g=(h={},h[a]=t,h[s]=n,h[i]=e,h)[p]||1,m=this.$d.getTime()+r*g;return C.w(m,this)},m.subtract=function(e,t){return this.add(-1*e,t)},m.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=C.z(this),a=this.$H,s=this.$m,o=this.$M,c=n.weekdays,l=n.months,u=function(e,n,i,a){return e&&(e[n]||e(t,r))||i[n].slice(0,a)},d=function(e){return C.s(a%12||12,e,"0")},h=n.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:C.s(o+1,2,"0"),MMM:u(n.monthsShort,o,l,3),MMMM:u(l,o),D:this.$D,DD:C.s(this.$D,2,"0"),d:String(this.$W),dd:u(n.weekdaysMin,this.$W,c,2),ddd:u(n.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(a),HH:C.s(a,2,"0"),h:d(1),hh:d(2),a:h(a,s,!0),A:h(a,s,!1),m:String(s),mm:C.s(s,2,"0"),s:String(this.$s),ss:C.s(this.$s,2,"0"),SSS:C.s(this.$ms,3,"0"),Z:i};return r.replace(x,(function(e,t){return t||p[e]||i.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,h,f){var p,x=C.p(h),g=k(r),m=(g.utcOffset()-this.utcOffset())*t,v=this-g,b=C.m(this,g);return b=(p={},p[d]=b/12,p[l]=b,p[u]=b/3,p[c]=(v-m)/6048e5,p[o]=(v-m)/864e5,p[s]=v/n,p[a]=v/t,p[i]=v/e,p)[x]||v,f?b:C.a(b)},m.daysInMonth=function(){return this.endOf(l).$D},m.$locale=function(){return j[this.$L]},m.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=y(e,t,!0);return r&&(n.$L=r),n},m.clone=function(){return C.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},g}(),Z=S.prototype;return k.prototype=Z,[["$ms",r],["$s",i],["$m",a],["$H",s],["$W",o],["$M",l],["$y",d],["$D",h]].forEach((function(e){Z[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),k.extend=function(e,t){return e.$i||(e(t,S,k),e.$i=!0),k},k.locale=y,k.isDayjs=w,k.unix=function(e){return k(1e3*e)},k.en=j[b],k.Ls=j,k.p={},k}()},3284:function(e){e.exports=async function(e,n,r,i){let a=await e(),s=0;for(;!n(a);){if(s>i)return null;await t(r),a=await e(),s+=r}return a};const t=function(e){return new Promise((t=>{setTimeout(t,e)}))}},55406:function(e,t,n){"use strict";function r(e,t,n,r){var i=Math.max(Math.min(r,(n-1)/2),0),a=e-i,s=a<0?n+a:a,o=(e+i)%n;return s<o&&t>=s&&t<=o||s>=o&&(t>=s||t<=o)}n.d(t,{Z:function(){return r}})},68106:function(e,t,n){"use strict";n.d(t,{t:function(){return Te},_i:function(){return Ne},io:function(){return Fe}});var r=n(71874),i=n(71158),a=n(53203),s=n(24037),o=n(82402),c=n(62102),l=n(35230),u=n.n(l),d=n(24246),h=n(27378),f=n(62332),p=n(34896),x=n(29549),g=n(31923),m=n(46213),v=n(43775),b=n(86677),j=n(68891),w=n(56552),y=n(59389),k=n(27693),C=n.n(k),S=n(79894),Z=n.n(S),z=n(97132),I=n(1577),M=n(46608),$=n(41716),D=n(59312);function E(e,t,n){void 0===t&&(t=[]),void 0===n&&(n={loading:!1});var r=(0,h.useRef)(0),i=function(){var e=(0,h.useRef)(!1),t=(0,h.useCallback)((function(){return e.current}),[]);return(0,h.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),t}(),a=(0,h.useState)(n),s=a[0],o=a[1],c=(0,h.useCallback)((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=++r.current;return s.loading||o((function(e){return(0,D.pi)((0,D.pi)({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return i()&&a===r.current&&o({value:e,loading:!1}),e}),(function(e){return i()&&a===r.current&&o({error:e,loading:!1}),e}))}),t);return[s,c]}function _(e,t){void 0===t&&(t=[]);var n=E(e,t,{loading:!0}),r=n[0],i=n[1];return(0,h.useEffect)((function(){i()}),[i]),r}var W=(0,y.m$)("div",{baseStyle:{position:"absolute",backgroundColor:"white",width:"100px",height:"100px",rounded:6,borderColor:"gray.300",borderWidth:"1px",borderStyle:"solid",shadow:"md"}}),O=function(e){var t=e.isMobile;return(0,d.jsxs)(p.kC,{alignSelf:t?"flex-start":"center",alignItems:"center",gap:1,bgColor:"gray.200",borderRadius:"20px",py:1,px:2,children:[(0,d.jsx)(I.Pz,{color:"#768089",fontSize:"xs"}),(0,d.jsx)(p.xu,{fontSize:"x-small",fontWeight:"bold",color:"#768089",children:"Downloaded"})]})},T=function(e){var t=e.batch,n=e.onClick,r=function(e){var t=e.children;return(0,d.jsxs)(p.kC,{flexDir:"row",alignItems:"center",gap:2,children:[(0,d.jsx)(I.zM,{color:"#fcc017"}),t]})};return"failed"===t.state?(0,d.jsx)(r,{children:(0,d.jsx)(p.xv,{fontSize:"x-small",children:"Batch couldn't be processed."})}):t.failedTaskCount&&0!==t.failedTaskCount?(0,d.jsxs)(p.kC,{flexDir:"row",alignItems:"center",gap:2,children:[(0,d.jsx)(I.zM,{color:"#fcc017"}),(0,d.jsxs)(x.zx,{variant:"unstyled",height:"auto",fontSize:"x-small",fontWeight:"normal",textDecoration:"underline",onClick:n,children:[t.failedTaskCount," file",t.failedTaskCount>1?"s":""," could not be processed"]})]}):(0,d.jsx)(p.xu,{})},R=function(e){var t,n=e.batch,i=e.thumbnailContainerWidth,o=e.isMobile,c=void 0!==o&&o,l=e.onThumbnailWidthChange,f=function(){y(!0)},x=(0,h.useState)(1),v=x[0],b=x[1],j=(0,h.useState)(!1),w=j[0],y=j[1],k=30-C()().diff(C()(n.createdAt),"day"),S=(0,h.useRef)(),D=_((0,r.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.t2.get("/api/batches/".concat(n.id,"/tasks?state=failed"));case 2:return t=e.sent,e.abrupt("return",t.data.data.tasks);case 4:case"end":return e.stop()}}),e)}))),[n.id]),E=(0,g.Sx)({base:{width:50,height:50},sm:{width:60,height:60},lg:{width:70,height:70}}),R=(0,h.useMemo)((function(){return S.current||(S.current=n.thumbnailUrl),S.current}),[n]),A=(0,h.useMemo)((function(){return E?{width:E.width*v,height:E.height}:{width:50,height:50}}),[v,E]),N=(0,h.useMemo)((function(){return{path:"/animations/loading.json"}}),[]);return(0,h.useEffect)((function(){l(n.id,A.width)}),[n.id,A.width,l]),(0,d.jsxs)(z.M2,{condition:c,wrapper:function(e){return(0,d.jsxs)(p.kC,{flexDir:"column",children:[e,"processing"!==n.state&&(0,d.jsxs)(p.kC,{flexDir:"row",justifyContent:"space-between",px:4,pt:2,pb:0,children:[(0,d.jsx)(T,{batch:n,onClick:f}),(0,d.jsxs)(p.xv,{color:"gray.500",fontSize:"x-small",children:["Batch will be deleted in ",k," days."]})]})]})},children:[(0,d.jsxs)(F,{flexDir:"row",p:4,gap:{base:3,lg:8},children:[(0,d.jsx)(p.kC,{mt:{base:4,lg:6},mr:{base:4,lg:6},width:null!==i&&void 0!==i?i:210,justifyContent:"center",children:(0,d.jsxs)(p.xu,{position:"relative",children:[(0,d.jsx)(W,(0,s.Z)((0,a.Z)({},(0,M.Z)(A)),{top:{base:-4,lg:-6},right:{base:-4,lg:-6}})),(0,d.jsx)(W,(0,s.Z)((0,a.Z)({},(0,M.Z)(A)),{top:{base:-2,lg:-3},right:{base:-2,lg:-3}})),(0,d.jsx)(m.Ee,(0,s.Z)((0,a.Z)({position:"relative"},(0,M.Z)(A)),{maxWidth:"none",objectFit:"cover",rounded:6,borderColor:"gray.300",borderWidth:"1px",borderStyle:"solid",src:null!==R&&void 0!==R?R:void 0,alt:"Original image",onLoad:function(e){b(e.currentTarget.width/e.currentTarget.height)},fallback:(0,d.jsx)(W,(0,s.Z)((0,a.Z)({position:"relative"},(0,M.Z)(A)),{children:"processing"===n.state&&(0,d.jsx)(z.qf,(0,a.Z)({options:N},(0,M.Z)(A)))}))}))]})}),(0,d.jsxs)(p.kC,{flexDir:"column",flexGrow:1,gap:1,children:[(0,d.jsxs)(p.xu,{fontSize:"x-small",children:[C()(n.createdAt).format("dddd, MMMM DD, hh:mm a")," |"," ",n.taskCount," files"]}),(0,d.jsx)(p.xu,{fontSize:{base:"sm",sm:"md",lg:"xl"},children:n.name}),"processing"!==n.state&&!c&&(0,d.jsx)(T,{batch:n,onClick:f}),n.downloadedAt&&c&&(0,d.jsx)(O,{isMobile:c})]}),(0,d.jsxs)(p.kC,{gap:2,children:[n.downloadedAt&&!c&&(0,d.jsx)(O,{isMobile:c}),(0,d.jsxs)(p.kC,{flexDir:"column",alignItems:"flex-end",gap:2,children:["processing"!==n.state&&!c&&(0,d.jsx)(p.xv,{fontSize:"x-small",children:"\xa0"}),"processing"===n.state&&(c?(0,d.jsx)(Z(),{href:"/batch/".concat(n.id),passHref:!0,children:(0,d.jsx)(p.rU,{children:(0,d.jsx)(I.LH,{fontSize:"24px",color:"palette.2"})})}):(0,d.jsx)(z.Qj,{href:"/batch/".concat(n.id),inverted:!0,children:"Show details"})),"processed"===n.state&&n.downloadUrl&&(c?(0,d.jsx)(Z(),{href:n.downloadUrl,passHref:!0,children:(0,d.jsx)(p.rU,{children:(0,d.jsx)(I._8,{fontSize:"24px",color:"palette.2"})})}):(0,d.jsx)(z.Qj,{href:n.downloadUrl,inverted:!0,children:"Download .zip"})),"failed"===n.state&&!c&&(0,d.jsx)(z.Qj,{href:"",disabled:!0,children:"Download .zip"}),"processing"!==n.state&&!c&&(0,d.jsxs)(p.xv,{color:"gray.500",fontSize:"x-small",children:["Batch will be deleted in ",k," days."]})]})]})]}),!D.loading&&D.value&&(0,d.jsx)(z.oF,{open:w,onClose:function(){y(!1)},errors:D.value.map((function(e){return{fileName:e.originalImageName,msg:null!==(t=e.errorMessage)&&void 0!==t?t:""}}))})]})},A=function(e){var t,n=e.batch,i=(0,h.useState)(!1),a=i[0],s=i[1],o=Boolean(n.archivedAt),c=30-C()().diff(C()(n.createdAt),"day"),l=_((0,r.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.t2.get("/api/batches/".concat(n.id,"/tasks?state=failed"));case 2:return t=e.sent,e.abrupt("return",t.data.data.tasks);case 4:case"end":return e.stop()}}),e)}))),[n.id]);return(0,d.jsxs)(p.kC,{flexDir:"column",alignItems:"center",children:[o?(0,d.jsx)(I.QW,{color:"palette.3",fontSize:"60px"}):(0,d.jsx)(I.Pz,{color:"#00E3A0",fontSize:"60px"}),(0,d.jsx)(p.X6,{maxWidth:"500px",lineHeight:{base:"40px",md:"52px"},textAlign:"center",my:7,children:o?"Download expired":"Your designs are ready to download"}),!o&&(0,d.jsxs)(p.kC,{gap:5,flexDir:"column",alignItems:"center",children:[n.downloadUrl&&(0,d.jsx)(z.Qj,{href:n.downloadUrl,children:"Download .zip"}),!!n.failedTaskCount&&n.failedTaskCount>0&&(0,d.jsxs)(p.kC,{flexDir:"row",alignItems:"center",gap:2,children:[(0,d.jsx)(I.zM,{color:"#fcc017"}),(0,d.jsxs)(x.zx,{variant:"unstyled",height:"auto",fontSize:"xs",fontWeight:"normal",textDecoration:"underline",onClick:function(){s(!0)},children:[n.failedTaskCount," file",n.failedTaskCount>1?"s":""," could not be processed"]})]}),(0,d.jsxs)(p.xv,{fontSize:"xs",children:["Batch will be deleted in ",c," days"]})]}),!l.loading&&l.value&&(0,d.jsx)(z.oF,{open:a,onClose:function(){s(!1)},errors:l.value.map((function(e){return{fileName:e.originalImageName,msg:null!==(t=e.errorMessage)&&void 0!==t?t:""}}))})]})},N=n(55021),F=function(e){var t=e.children,n=(0,N.Z)(e,["children"]);return(0,d.jsx)(p.kC,(0,s.Z)((0,a.Z)({flexDir:"column",width:"100%",alignItems:"center",backgroundColor:"white",borderRadius:5,gap:10,p:8},n),{children:t}))},P=n(83125),U=n(44833),L=n(5662),B=function(e){var t=e.files,n=e.previewElements,i=e.numberOfPreviewImages,o=e.thumbnailSize,l=e.onFilesChange,f=(0,h.useState)(!1),g=f[0],v=f[1],b=(0,h.useState)([]),j=b[0],w=b[1],y=(0,h.useState)(!1),k=y[0],C=y[1];(0,h.useEffect)((function(){j.length>0&&v(!0)}),[j]);var S=(0,h.useCallback)((function(e){var r,a,s=function(e){return{file:e,objectURL:URL.createObjectURL(e)}};if(n.length<i){var o=i-n.length,u=(o>e.length?e:e.slice(0,o)).map(s);a=(0,c.Z)(n).concat((0,c.Z)(u)),r=(0,c.Z)(t).concat((0,c.Z)(e))}else{var d=e.slice(0,Math.min(e.length,i)).map(s);a=(0,c.Z)(d).concat((0,c.Z)(n)).slice(0,i),r=(0,c.Z)(e).concat((0,c.Z)(t));for(var h=i-d.length;h<i;h++)URL.revokeObjectURL(n[h].objectURL)}l(r,a)}),[t,i,l,n]),Z=(0,U.uI)({onDrop:S,getFilesFromEvent:function(){var e=(0,r.Z)(u().mark((function e(t){var n,r,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.next=3,(0,L.i)(t);case 3:return n=e.sent,r=n.validFiles,i=n.inValidFiles,C(!1),w(i),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),useFsAccessApi:!1,accept:{"image/*":[".png",".jpeg",".jpg"]},noClick:!0,noKeyboard:!0}),$=Z.getRootProps,D=Z.getInputProps,E=Z.isDragActive,_=Z.open;return(0,d.jsxs)(p.xu,(0,s.Z)((0,a.Z)({position:"relative"},$()),{children:[(0,d.jsx)("input",(0,a.Z)({},D())),k&&(0,d.jsx)(z.cF,{children:(0,d.jsxs)(p.kC,{flexDir:"column",alignItems:"center",color:"white",children:[(0,d.jsx)(P.$,{thickness:"4px",size:"xl",mb:8}),(0,d.jsx)(p.X6,{size:"md",mb:4,children:"Adding images..."})]})}),(0,d.jsxs)(p.kC,{flex:1,flexDir:"column",justifyContent:"center",py:t.length>0?0:32,children:[(0,d.jsx)(x.zx,{_hover:{background:t.length>0?"white":"palette.2"},_active:{background:t.length>0?"white":"palette.2"},color:t.length>0?"palette.2":"white",fontSize:"xl",fontWeight:"bold",background:t.length>0?"white":"palette.2",borderWidth:"1px",borderColor:t.length>0?"palette.2":"white",height:"auto",py:2,px:8,mb:2,mx:"auto",leftIcon:(0,d.jsx)(I.rG,{fontSize:"2rem"}),onClick:_,children:"Select Images"}),(0,d.jsx)(p.xv,{fontSize:"md",textAlign:"center",color:"gray.900",display:{base:"none",lg:"block"},children:"or drop files and folders"})]}),t.length>0&&(0,d.jsxs)(p.kC,{wrap:"wrap",mt:6,pt:6,gap:6,children:[n.map((function(e,t){return(0,d.jsx)(m.Ee,{height:(0,M.Z)(o).height,alt:"",src:e.objectURL},t)})),t.length-n.length>0&&(0,d.jsx)(p.kC,(0,s.Z)((0,a.Z)({},(0,M.Z)(o)),{justifyContent:"center",alignItems:"center",textAlign:"center",bgColor:"#F7F7F7",children:(0,d.jsxs)(p.xv,{fontSize:"sm",children:["+ ",t.length-n.length," more"]})}))]}),E&&(0,d.jsx)(p.kC,{position:"absolute",width:"100%",height:"100%",top:0,left:0,justifyContent:"center",alignItems:"center",backgroundColor:"white",borderRadius:5,borderWidth:10,borderStyle:"dashed",borderColor:"palette.2",children:(0,d.jsxs)(p.xu,{textAlign:"center",children:[(0,d.jsx)(p.X6,{size:"2xl",mb:4,children:"Drop images here"}),(0,d.jsx)(p.xv,{fontWeight:"600",children:"(supported types are jpg and png)"})]})}),(0,d.jsx)(z.oF,{open:g,onClose:function(){v(!1),w([])},errors:j.map((function(e){return{fileName:e.file.name,msg:e.error.message}})),header:"".concat(j.length," image").concat(j.length>1?"s":""," could not be selected"),footer:"OK"})]}))},H=n(63380),Y=function(e){var t=e.step,n=e.progress,r=e.action;return(0,d.jsxs)(p.kC,{flexDir:"column",width:"100%",maxWidth:"600px",gap:2,children:[(0,d.jsx)(H.Ex,{value:n,width:"100%",bgColor:"gray.200",borderRadius:20}),(0,d.jsxs)(p.xv,{fontSize:"sm",children:[(0,d.jsxs)(p.xu,{as:"span",fontWeight:"bold",children:["Step ",t," of 2:"]})," ",r,"... ",n,"%"]})]})},Q=function(e){var t=e.uploads,n=e.selectedTemplate,r=e.numberOfRemainingImages,i=e.thumbnailSize,o=(0,h.useMemo)((function(){return{width:i.width*n.aspectRatio,height:i.height}}),[n.aspectRatio,i.height,i.width]);return(0,d.jsxs)(p.kC,{flexWrap:"wrap",gap:6,children:[t.map((function(e,t){return e&&100===e.progress&&e.imageId?(0,d.jsx)(ae,{templateId:n.id,imageId:e.imageId,placeholderCanvasSize:o},t):(0,d.jsx)(v.Od,(0,a.Z)({},(0,M.Z)(o)),t)})),r>0&&(0,d.jsx)(p.kC,(0,s.Z)((0,a.Z)({justifyContent:"center",alignItems:"center",textAlign:"center",bgColor:"#F7F7F7"},(0,M.Z)(o)),{children:(0,d.jsxs)(p.xv,{fontSize:"sm",children:["+ ",r," more"]})}))]})},q=n(388),G=n(10043),V=n(87228),X=n(54837),J=(n(15560),n(19159)),K=n(34412),ee=n.n(K),te=n(55406);function ne(){var e=(0,q.Z)(["\n            .carousel-root {\n              width: 100%;\n              flex-grow: 1;\n            }\n\n            .carousel .slide {\n              display: flex;\n              justify-content: center;\n              background: none;\n            }\n          "]);return ne=function(){return e},e}var re=(0,y.m$)(x.zx,{baseStyle:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",position:"absolute",fontSize:{base:"24px",md:"48",lg:"60px"},zIndex:5,color:"gray.400"}}),ie=function(e){var t,n=e.imageId,i=e.selectedTemplateId,s=e.thumbnailSize,l=e.loadFromCache,f=void 0===l||l,g=e.onTemplateSelect,m=function(e){g(e)},b=(0,h.useState)(0),y=b[0],k=b[1],C=(0,h.useState)(0),S=C[0],Z=C[1],z=ee()(),I=z.ref,D=z.width,E=void 0===D?1:D,_=(0,w.useQuery)(["user/templates",n],(0,r.Z)(u().mark((function e(){var t,r,i,a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={"image-id":n},r=j.stringifyUrl({url:"/api/user/templates",query:t},{skipNull:!0}),e.next=4,$.t2.get(r);case 4:return i=e.sent,a=(0,o.Z)(i.data.data,1),s=a[0],e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)}))),{refetchOnMount:!f}).data,W=void 0===_?[]:_,O=(0,w.useQuery)(["categories",n],(0,r.Z)(u().mark((function e(){var t,r,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={"image-id":n},r=j.stringifyUrl({url:"/gallery",query:t},{skipNull:!0}),e.next=4,$.ZP.get(r);case 4:return i=e.sent,a=i.data.data,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)}))),{refetchOnMount:!f}).data,T=void 0===O?[]:O,R=(0,h.useMemo)((function(){var e,t=[];(W.length>0&&t.push({id:null,name:"My designs",templates:(0,J.pj)(W),description:""}),T.length>0)&&(e=t).push.apply(e,(0,c.Z)(T));return t}),[T,W]),A=(0,h.useMemo)((function(){return 1===E?[]:R.map((function(e,t){return function(e){var t=R[e],n=[[]];return t.templates.reduce((function(e,t){var r={width:s.width*t.aspectRatio,height:s.height},i=r.width+16;if(i>E){var o=(i-E)/r.width;r.width=r.width*(1-o),r.height=r.height*(1-o),i=r.width+16}return e+i>E?(e=i,n.push([(0,a.Z)({canvasSize:r},t)])):(e+=i,n[n.length-1].push((0,a.Z)({canvasSize:r},t))),e}),0),n}(t)}))}),[s,R,E]),N=(0,h.useCallback)((function(e){return e.findIndex((function(e){return e.find((function(e){return e.id===i}))}))}),[i]);return(0,h.useEffect)((function(){i&&A.some((function(e,t){var n=N(e);return n>-1&&(k(t),Z(n),!0)}))}),[A,N,i]),(0,d.jsxs)(p.xu,{children:[(0,d.jsx)(p.kC,{columnGap:8,rowGap:4,justifyContent:"center",flexWrap:"wrap",children:R.map((function(e,n){return(0,d.jsx)(x.zx,{variant:"unstyled",p:0,height:"auto",minHeight:"auto",color:y===n?"palette.2":"gray.900",fontSize:"xs",fontWeight:y===n?"bold":"normal",borderRadius:0,borderBottomWidth:y===n?3:0,borderColor:"palette.2",onClick:function(){return function(e){var t=N(A[e]);Z(t>-1?t:0),k(e)}(n)},children:e.name},null!==(t=e.id)&&void 0!==t?t:n)}))}),(0,d.jsxs)(p.xu,{flex:"1",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",mt:6,mb:4,px:{base:4,md:12,lg:16},overflow:"hidden",children:[(0,d.jsx)(G.xB,{styles:(0,G.iv)(ne())}),A[y]&&A[y].length>1&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(re,{variant:"unstyled",left:{base:"-12px",md:"-4px",lg:0},onClick:function(){Z(S-1)},children:(0,d.jsx)(V.bUI,{})}),(0,d.jsx)(re,{variant:"unstyled",right:{base:"-12px",md:"-4px",lg:0},onClick:function(){Z(S+1)},children:(0,d.jsx)(V.Dli,{})})]}),(0,d.jsx)(p.xu,{ref:I,display:"flex",flexDirection:"column",width:"100%",children:(0,d.jsx)(X.lr,{infiniteLoop:!0,autoPlay:!1,showStatus:!1,showIndicators:!1,showThumbs:!1,showArrows:!1,selectedItem:S,onChange:function(e){Z(e)},children:A[y]&&A[y].map((function(e,t){return(0,te.Z)(S,t,A[y].length,3)?(0,d.jsx)(p.xu,{display:"flex",flexDir:"row",justifyContent:"center",alignItems:"flex-end",gap:"".concat(16,"px"),children:e.map((function(e){return n?(0,d.jsx)(ae,{name:e.name,templateId:e.id,imageId:n,placeholderCanvasSize:e.canvasSize,isSelected:i===e.id,onSelect:m},e.id):(0,d.jsx)(v.Od,(0,a.Z)({},(0,M.Z)(e.canvasSize)),e.id)}))},t):(0,d.jsx)(p.xu,{},t)}))})})]})]})},ae=function(e){var t=e.name,n=e.templateId,o=e.imageId,c=e.placeholderCanvasSize,l=e.isSelected,f=e.onSelect,x=(0,N.Z)(e,["name","templateId","imageId","placeholderCanvasSize","isSelected","onSelect"]),g=(0,w.useQuery)(["template",n,o,!0],(0,r.Z)(u().mark((function e(){var t,r,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=j.stringify((t={},(0,i.Z)(t,"image-id",o),(0,i.Z)(t,"res","thumbnail"),t),{skipNull:!0}),e.next=4,$.ZP.get("/templates/".concat(n,"?").concat(r));case 4:return a=e.sent,e.abrupt("return",a.data.data);case 6:case"end":return e.stop()}}),e)})))),m=g.isLoading,v=g.data,b=(0,h.useMemo)((function(){return m||!(null===v||void 0===v?void 0:v.aspectRatio)?c:{height:c.height,width:v.aspectRatio*c.height}}),[c,m,null===v||void 0===v?void 0:v.aspectRatio]);return(0,d.jsxs)(p.kC,(0,s.Z)((0,a.Z)({_hover:{cursor:f?"pointer":"default"},flexDir:"column",position:"relative",onClick:function(){f&&v&&f(v.id)}},x),{children:[(0,d.jsx)(z.YS,{transition:"box-shadow .1s linear",loading:m,template:v,canvasSize:b}),l&&(0,d.jsx)(p.xu,(0,s.Z)((0,a.Z)({position:"absolute",top:0,left:0},(0,M.Z)(b)),{borderWidth:l?3:0,borderColor:"palette.2"})),t&&(0,d.jsx)(p.xv,{noOfLines:1,width:(0,M.Z)(b).width,height:{base:"14px",lg:"16px"},fontSize:{base:"xx-small",lg:"xs"},color:"gray.500",textAlign:"left",children:t})]}))},se=n(51729),oe=n(49031);function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ce.apply(this,arguments)}function le(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var ue=["spacing"],de=["isCurrentPage","as","className","href"],he=["isCurrentPage","separator","isLastChild","spacing","children","className"],fe=["children","spacing","separator","className"],pe=(0,y.eC)("Breadcrumb"),xe=pe[0],ge=pe[1],me=(0,y.Gp)((function(e,t){var n=e.spacing,r=le(e,ue),i=ce({mx:n},ge().separator);return h.createElement(y.m$.span,ce({ref:t,role:"presentation"},r,{__css:i}))}));se.Ts&&(me.displayName="BreadcrumbSeparator");var ve=(0,y.Gp)((function(e,t){var n=e.isCurrentPage,r=e.as,i=e.className,a=e.href,s=le(e,de),o=ge(),c=ce({ref:t,as:r,className:(0,se.cx)("chakra-breadcrumb__link",i)},s);return n?h.createElement(y.m$.span,ce({"aria-current":"page",__css:o.link},c)):h.createElement(y.m$.a,ce({__css:o.link,href:a},c))}));se.Ts&&(ve.displayName="BreadcrumbLink");var be=(0,y.Gp)((function(e,t){var n=e.isCurrentPage,r=e.separator,i=e.isLastChild,a=e.spacing,s=e.children,o=e.className,c=le(e,he),l=(0,oe.WR)(s).map((function(e){return e.type===ve?h.cloneElement(e,{isCurrentPage:n}):e.type===me?h.cloneElement(e,{spacing:a,children:e.props.children||r}):e})),u=ce({display:"inline-flex",alignItems:"center"},ge().item),d=(0,se.cx)("chakra-breadcrumb__list-item",o);return h.createElement(y.m$.li,ce({ref:t,className:d},c,{__css:u}),l,!i&&h.createElement(me,{spacing:a},r))}));se.Ts&&(be.displayName="BreadcrumbItem");var je=(0,y.Gp)((function(e,t){var n=(0,y.jC)("Breadcrumb",e),r=(0,y.Lr)(e),i=r.children,a=r.spacing,s=void 0===a?"0.5rem":a,o=r.separator,c=void 0===o?"/":o,l=r.className,u=le(r,fe),d=(0,oe.WR)(i),f=d.length,p=d.map((function(e,t){return h.cloneElement(e,{separator:c,spacing:s,isLastChild:f===t+1})})),x=(0,se.cx)("chakra-breadcrumb",l);return h.createElement(y.m$.nav,ce({ref:t,"aria-label":"breadcrumb",className:x,__css:n.container},u),h.createElement(xe,{value:n},h.createElement(y.m$.ol,{className:"chakra-breadcrumb__list"},p)))}));se.Ts&&(je.displayName="Breadcrumb");var we=n(32312),ye=function(e){var t=e.items;return(0,d.jsx)(je,{fontSize:"x-small",spacing:1,separator:(0,d.jsx)(we.jZo,{color:"gray.500"}),children:t.map((function(e,t){return(0,d.jsx)(be,(0,s.Z)((0,a.Z)({},e.styles),{children:(0,d.jsx)(ve,{href:e.link,as:Z(),children:e.text})}),t)}))})},ke=n(93955),Ce=n(72172),Se=n(73868);class Ze{value;next;constructor(e){this.value=e}}class ze{#e;#t;#n;constructor(){this.clear()}enqueue(e){const t=new Ze(e);this.#e?(this.#t.next=t,this.#t=t):(this.#e=t,this.#t=t),this.#n++}dequeue(){const e=this.#e;if(e)return this.#e=this.#e.next,this.#n--,e.value}clear(){this.#e=void 0,this.#t=void 0,this.#n=0}get size(){return this.#n}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}}function Ie(e){if(!Number.isInteger(e)&&e!==Number.POSITIVE_INFINITY||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=new ze;let n=0;const r=async(e,r,i)=>{n++;const a=(async()=>e(...i))();r(a);try{await a}catch{}n--,t.size>0&&t.dequeue()()},i=(i,...a)=>new Promise((s=>{((i,a,s)=>{t.enqueue(r.bind(void 0,i,a,s)),(async()=>{await Promise.resolve(),n<e&&t.size>0&&t.dequeue()()})()})(i,s,a)}));return Object.defineProperties(i,{activeCount:{get:()=>n},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),i}var Me=n(45710),$e=function(e){(0,Me.Z)((function(){e()}))},De=n(30627),Ee=n(56789),_e=n(3284),We=function(e){var t=e.index,n=e.currentStep,r=e.title,i=e.disabled,a=e.inActiveNode,s=e.children;return(0,d.jsx)(f.Qd,{display:t>n?"none":"block",bgColor:"white",border:0,borderRadius:5,mb:6,children:function(e){var n=e.isExpanded;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(f.KF,{_hover:{bgColor:"white",cursor:n||i?"default":"cursor"},px:6,pr:n?6:2,py:2,children:(0,d.jsxs)(p.kC,{width:"100%",height:"40px",justifyContent:"space-between",alignItems:"center",color:i?"gray.500":"gray.900",gap:2,children:[(0,d.jsxs)(p.X6,{as:"h2",fontSize:16,lineHeight:"16px",textAlign:"left",whiteSpace:"nowrap",children:[t+1,". ",r]}),!n&&a]})}),(0,d.jsx)(f.Hk,{p:6,children:s})]})}})},Oe=[{text:"Batch Editor",link:"/batch",styles:{fontWeight:"bold"}},{text:"New Batch",link:"/batch/new"}],Te=function(e){var t,n,l,y=e.initialBatch,k=e.onBatchCreated,S=function(e){return[Oe[0],{text:"".concat(e.name," (").concat(C()(e.createdAt).format("dddd, MMMM DD, hh:mm a"),")"),link:"/batch/".concat(e.id)}]},Z=function(){q((0,d.jsxs)(p.xu,{fontSize:"sm",children:[(0,d.jsxs)(p.xv,{textAlign:"center",color:"palette.3",children:["Your are exceeding the fair use limit."," ",(0,d.jsx)(p.rU,{href:"mailto:support@designify.com",fontWeight:"bold",textDecoration:"underline",children:"Get in touch with support"}),"."]}),(0,d.jsxs)(p.xv,{textAlign:"center",color:"palette.3",children:["If you want to reset your uploads"," ",(0,d.jsx)(x.zx,{variant:"unstyled",fontSize:"sm",textDecoration:"underline",onClick:ct,children:"click here."})]})]}))},I=function(e){var t=j.parseUrl(window.location.href),n=t.url,r=t.query,i=j.stringifyUrl({url:n,query:(0,s.Z)((0,a.Z)({},r),{designId:e})});_.replace(i,void 0,{shallow:!0})},D=function(e,t,n){var r=new FormData;return r.append("file",t,t.name),$.t2.post("/api/batches/".concat(e,"/tasks"),r,n)},E=function(e){_.replace("/batch/".concat(e),void 0,{shallow:!0})},_=(0,b.useRouter)(),W=_.query.designId,O=(0,ke.oR)().batchEditorStore,T=(0,w.useQueryClient)(),R=(0,Ce.H4)(),N=(0,h.useState)(null!==y&&void 0!==y?y:null),P=N[0],U=N[1],L=(0,h.useState)(null),H=L[0],q=L[1],G=(0,h.useState)(y?S(y):Oe),V=G[0],X=G[1],J=(0,h.useState)(y?3:0),K=J[0],ee=J[1],te=(0,h.useState)([0]),ne=te[0],re=te[1],se=(0,h.useState)([]),oe=se[0],ce=se[1],le=(0,h.useState)([]),ue=le[0],de=le[1],he=(0,h.useState)(null),fe=he[0],pe=he[1],xe=(0,h.useState)(null),ge=xe[0],me=xe[1],ve=(0,h.useState)(null!==(n=Boolean(y))&&void 0!==n&&n),be=ve[0],je=ve[1],we=(0,h.useState)(0),Ze=we[0],ze=we[1],Me=(0,h.useRef)([]),Te=(0,h.useState)(Me.current),Re=Te[0],Ae=Te[1],Ne=(0,Ce.fr)({}).uploadImage,Fe={_hover:{cursor:be?"default":"pointer"},filter:"opacity(".concat(be?.5:1,")")},Pe=(0,h.useState)(!1),Ue=Pe[0],Le=Pe[1],Be=(0,h.useState)([]),He=Be[0],Ye=Be[1],Qe=(0,h.useRef)(!0),qe=(0,g.Sx)({base:!0,md:!1}),Ge=(0,h.useMemo)((function(){return{base:{width:100,height:100},md:{width:120,height:120},lg:{width:135,height:135}}}),[]),Ve=(0,g.Sx)({base:Ge.base,md:Ge.md,lg:Ge.lg}),Xe=[{text:"Next",disabled:!fe||oe.length<=0||oe.length>fe,onClick:(0,r.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dt([ue[0].file]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},{text:"Next",disabled:!ge,onClick:function(){return dt(ue.map((function(e){return e.file})))}},{text:"Process ".concat(oe.length," files"),disabled:!1,onClick:function(){return ge&&ft(oe,ue,ge)}}];(0,Ee.x)((function(e){P&&"pending"===P.state&&e.preventDefault()}));var Je,Ke,et,tt=(0,h.useMemo)((function(){var e;return null!==(l=null===(e=Re[0])||void 0===e?void 0:e.imageId)&&void 0!==l?l:null}),[Re]),nt=(0,h.useMemo)((function(){return{path:"/animations/loading.json"}}),[]),rt=(0,h.useMemo)((function(){var e,t=[];if(ue.length>0)(e=t).push.apply(e,(0,c.Z)(ue.map((function(e){return{original:e.objectURL}}))));else for(var n=0;n<5;n++)if(He[n]){var r=He[n],i=r.thumbnailUrl,a=r.designThumbnailUrl;t.push({original:i,design:a})}return qe?t[0]?[t[0]]:[]:t}),[qe,ue,He]),it=(0,h.useMemo)((function(){return oe.length>0?oe.length:(null===P||void 0===P?void 0:P.taskCount)?P.taskCount:0}),[null===P||void 0===P?void 0:P.taskCount,oe.length]),at=(0,h.useCallback)(function(){var e=(0,r.Z)(u().mark((function e(t,n){var r,a,s,o,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=T.getQueryData(["template",t,n,!0]))){e.next=3;break}return e.abrupt("return",r);case 3:return s=j.stringify((a={},(0,i.Z)(a,"image-id",n),(0,i.Z)(a,"res","thumbnail"),a),{skipNull:!0}),e.next=7,R($.ZP.get("/templates/".concat(t,"?").concat(s)),{skipErrorHandling:function(e,t){return"TEMPLATE_NOT_FOUND"===(null===t||void 0===t?void 0:t.code)}});case 7:if(!(null===(o=e.sent)||void 0===o?void 0:o.apiErrors)||"TEMPLATE_NOT_FOUND"!==o.apiErrors[0].code){e.next=10;break}return e.abrupt("return",null);case 10:if(!(c=o.data.data)){e.next=14;break}return T.setQueryData(["template",t,n,!0],c),e.abrupt("return",c);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[R,T]),st=(0,h.useCallback)(function(){var e=(0,r.Z)(u().mark((function e(t){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R($.t2.get("/api/batches/".concat(t,"/tasks")),{skipErrorHandling:function(){return!0}});case 2:return n=e.sent,e.abrupt("return",null!==(r=n.data.data.tasks)&&void 0!==r?r:null);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[R]),ot=(0,h.useCallback)(function(){var e=(0,r.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:(r=e.sent)&&Qe.current&&n(r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[]);function ct(){return lt.apply(this,arguments)}function lt(){return lt=(0,r.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$.t2.get("/api/batches");case 3:if(t=e.sent,-1===t.data.data.batches.findIndex((function(e){return"processing"===e.state}))){e.next=8;break}return Le(!0),e.abrupt("return");case 8:Le(!1),e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),Le(!0),e.abrupt("return");case 15:_.replace("/batch/new",void 0,{shallow:!0}),U(null),Ye([]),je(!1),q(null),ee(0),re([]),X(Oe),ce([]),de([]),pe(null),me(null),Me.current=[],Ae((0,c.Z)(Me.current));case 29:case"end":return e.stop()}}),e,null,[[0,11]])}))),lt.apply(this,arguments)}function ut(){return(ut=(0,r.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,null!==fe){e.next=8;break}return e.next=4,(0,De.r)();case 4:r=e.sent,pe(r),e.next=9;break;case 8:r=fe;case 9:(!r||t.length>r)&&Z(),ce(t),de(n),me(null),Me.current=Array.from({length:Math.min(t.length,5)},(function(){return null})),Ae((0,c.Z)(Me.current));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(e){return ht.apply(this,arguments)}function ht(){return ht=(0,r.Z)(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,De.r)();case 2:if(n=e.sent,pe(n),n&&!(t.length>n)){e.next=7;break}return Z(),e.abrupt("return");case 7:t.forEach(function(){var e=(0,r.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Me.current[n]){e.next=2;break}return e.abrupt("return");case 2:return Me.current[n]={progress:0,imageId:null},Ae((0,c.Z)(Me.current)),e.next=6,Ne(t,{generateOnlyBasicImageModifiers:null!==ge&&!ge.dynamicAspectRatio,onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);Me.current[n]={progress:t,imageId:null},Ae((0,c.Z)(Me.current))}});case 6:r=e.sent,Me.current[n]={progress:100,imageId:null===r||void 0===r?void 0:r.data.id},Ae((0,c.Z)(Me.current));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)}))),ht.apply(this,arguments)}function ft(e,t,n){return pt.apply(this,arguments)}function pt(){return pt=(0,r.Z)(u().mark((function e(t,n,r){var i,a,s,o,c,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return je(!0),e.prev=1,e.next=4,(0,Se.getCsrfToken)();case 4:if(i=e.sent){e.next=7;break}throw new Error;case 7:return e.next=9,xt(r,i);case 9:return a=e.sent,U(a),e.next=13,mt(a,t,n,i);case 13:return e.next=15,bt(a,i);case 15:Qe.current&&E(a.id),k(a),X(S(a)),wt(a),e.next=27;break;case 21:e.prev=21,e.t0=e.catch(1),d=null===(s=e.t0.response)||void 0===s||null===(o=s.data)||void 0===o||null===(c=o.errors)||void 0===c||null===(l=c[0])||void 0===l?void 0:l.message,alert(null!==d&&void 0!==d?d:"Something went wrong!"),location.reload();case 27:case"end":return e.stop()}}),e,null,[[1,21]])}))),pt.apply(this,arguments)}function xt(e,t){return gt.apply(this,arguments)}function gt(){return(gt=(0,r.Z)(u().mark((function e(t,n){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.t2.post("/api/batches",{data:{name:t.name,designId:t.id}},{headers:{"x-csrf-token":n}});case 2:return r=e.sent,e.abrupt("return",r.data.data.batch);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mt(e,t,n,r){return vt.apply(this,arguments)}function vt(){return vt=(0,r.Z)(u().mark((function e(t,n,r,i){var a,s,c,l,d,h,f,p,x,g,m,v,b;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Array.from({length:n.length},(function(){return 0})),ze(0),s=setInterval((function(){var e=a.reduce((function(e,t){return e+t}),0);ze(Math.round(e/n.length)),e/n.length===100&&clearInterval(s)}),1e3),c=function(e){return{headers:{"x-csrf-token":i},onUploadProgress:function(t){var n=Math.round(100*t.loaded/t.total);a[e]=n}}},l=!0,d=!1,h=void 0,e.prev=5,f=r.entries()[Symbol.iterator]();case 7:if(l=(p=f.next()).done){e.next=14;break}return x=(0,o.Z)(p.value,2),g=x[0],m=x[1],e.next=11,D(t.id,m.file,c(g));case 11:l=!0,e.next=7;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),d=!0,h=e.t0;case 20:e.prev=20,e.prev=21,l||null==f.return||f.return();case 23:if(e.prev=23,!d){e.next=26;break}throw h;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return v=Ie(5),b=n.slice(5).map((function(e,n){return v((function(){return D(t.id,e,c(n+5))}))})),e.next=32,Promise.all(b);case 32:case"end":return e.stop()}}),e,null,[[5,16,20,28],[21,,23,27]])}))),vt.apply(this,arguments)}function bt(e,t){return jt.apply(this,arguments)}function jt(){return jt=(0,r.Z)(u().mark((function e(t,n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.t2.post("/api/batches/".concat(t.id,"/process"),void 0,{headers:{"x-csrf-token":n}});case 2:case"end":return e.stop()}}),e)}))),jt.apply(this,arguments)}function wt(e){return yt.apply(this,arguments)}function yt(){return yt=(0,r.Z)(u().mark((function e(t){var n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=function(){var e=(0,r.Z)(u().mark((function e(){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.t2.get("/api/batches/".concat(t.id));case 2:return n=e.sent,r=n.data.data.batch,Qe.current&&U(r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(e){return!Qe.current||"processed"===e.state},_e(n,i,3e3,1/0);case 3:case"end":return e.stop()}}),e)}))),yt.apply(this,arguments)}return $e((0,r.Z)(u().mark((function e(){var t,n,r,i,a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=O.files,n=O.templateId,r=O.imageIds,!(t&&r&&n)){e.next=16;break}return ee(3),e.next=5,at(n,r[0]);case 5:if(i=e.sent){e.next=8;break}return e.abrupt("return");case 8:me(i),ce(t),a=t.slice(0,5).map((function(e){return{file:e,objectURL:URL.createObjectURL(e)}})),de(a),s=r.map((function(e){return{imageId:e,progress:100}})),Ae(s),O.reset(),ft(t,a,i);case 16:case"end":return e.stop()}}),e)})))),(0,h.useEffect)((function(){function e(){return e=(0,r.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$.t2.get("/api/batches");case 3:if(t=e.sent,-1===t.data.data.batches.findIndex((function(e){return"processing"===e.state}))){e.next=8;break}return Le(!0),e.abrupt("return");case 8:Le(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),Le(!0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),e.apply(this,arguments)}y&&"processing"===y.state?(wt(y),Le(!1)):function(){e.apply(this,arguments)}()}),[y]),(0,h.useEffect)((function(){return Qe.current=!0,function(){Qe.current=!1}}),[]),(0,h.useEffect)((function(){"processing"!==(null===P||void 0===P?void 0:P.state)&&"processed"!==(null===P||void 0===P?void 0:P.state)||!y||(ot((function(){return st(P.id)}),Ye),P.designId&&ot((function(){return at(P.designId)}),me))}),[null===P||void 0===P?void 0:P.id,null===P||void 0===P?void 0:P.state,null===P||void 0===P?void 0:P.designId,y,st,at,ot]),(0,h.useEffect)((function(){W&&tt&&ot((function(){return at(W,tt)}),me)}),[ot,at,tt,W]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(p.xu,{display:{base:"none",md:"block"},pt:"100px",pl:"40px",children:(0,d.jsx)(ye,{items:V})}),(0,d.jsxs)(p.W2,{maxW:"990px",pt:{base:"92px",md:"calc(172px - 115px)"},px:0,mb:8,children:[(0,d.jsxs)(f.UQ,{index:K,allowMultiple:!1,allowToggle:!1,onChange:function(e){be||(ee(e),re((0,c.Z)(ne).concat([e])))},reduceMotion:!0,children:[(0,d.jsx)(We,{index:0,currentStep:K,title:"Select Images",disabled:be,inActiveNode:(0,d.jsx)(p.kC,{gap:2,children:rt.length>0?(0,d.jsxs)(d.Fragment,{children:[rt.map((function(e,t){return(0,d.jsx)(m.Ee,(0,a.Z)({height:"40px",alt:"",src:e.original},Fe),t)})),it-5>0&&(0,d.jsx)(p.kC,{width:"40px",height:"40px",justifyContent:"center",alignItems:"center",bgColor:"#F7F7F7",children:(0,d.jsxs)(p.xv,{fontSize:"sm",children:["+",it-rt.length]})})]}):(0,d.jsx)(p.xv,{fontSize:"sm",children:"Loading..."})}),children:Ve&&(0,d.jsx)(B,{files:oe,previewElements:ue,numberOfPreviewImages:5,thumbnailSize:Ve,onFilesChange:function(e,t){return ut.apply(this,arguments)}})}),(0,d.jsx)(We,{index:1,currentStep:K,title:"Select Design",disabled:be,inActiveNode:(0,d.jsxs)(p.kC,{flex:1,gap:2,minWidth:0,height:"40px",alignItems:"center",justifyContent:"flex-end",children:[ge&&(0,d.jsx)(p.xv,{fontSize:"sm",noOfLines:1,children:ge.name}),ge&&tt?(0,d.jsx)(z.YS,(0,a.Z)({template:ge,canvasSize:{width:40*ge.aspectRatio,height:40}},Fe)):P&&P.thumbnailUrl?(0,d.jsx)(m.Ee,(0,a.Z)({height:"40px",alt:"",src:P.thumbnailUrl},Fe)):(0,d.jsx)(v.Od,(0,a.Z)({},(0,M.Z)({width:40*(null!==(Je=null===ge||void 0===ge?void 0:ge.aspectRatio)&&void 0!==Je?Je:1),height:40})))]}),children:Ve&&(0,d.jsx)(ie,{imageId:tt,selectedTemplateId:W||null,thumbnailSize:Ve,loadFromCache:ne.slice(0,-1).includes(1),onTemplateSelect:function(e){I(e)}})}),(0,d.jsx)(We,{index:2,currentStep:K,title:"Preview",disabled:be,inActiveNode:(0,d.jsxs)(p.kC,{gap:2,height:"40px",alignItems:"center",children:[ge&&Re.length>0?qe?(0,d.jsx)(ae,(0,a.Z)({templateId:ge.id,imageId:null!==(Ke=null===Re||void 0===Re||null===(t=Re[0])||void 0===t?void 0:t.imageId)&&void 0!==Ke?Ke:"",placeholderCanvasSize:{width:40*ge.aspectRatio,height:40}},Fe)):Re.map((function(e,t){return e&&e.imageId&&(0,d.jsx)(ae,(0,a.Z)({templateId:ge.id,imageId:null===e||void 0===e?void 0:e.imageId,placeholderCanvasSize:{width:40*ge.aspectRatio,height:40}},Fe),t)})):rt.map((function(e,t){return e.design?(0,d.jsx)(m.Ee,(0,a.Z)({height:"40px",alt:"",src:e.design},Fe),t):(0,d.jsx)(v.Od,(0,a.Z)({},(0,M.Z)({width:40*(null!==(et=null===ge||void 0===ge?void 0:ge.aspectRatio)&&void 0!==et?et:1),height:40})),t)})),it-5>0&&(0,d.jsx)(p.kC,{width:"40px",height:"40px",justifyContent:"center",alignItems:"center",bgColor:"#F7F7F7",children:(0,d.jsxs)(p.xv,{fontSize:"sm",children:["+",it-rt.length]})})]}),children:2===K&&ge&&Ve&&(0,d.jsx)(Q,{uploads:Re,selectedTemplate:ge,numberOfRemainingImages:oe.length-5,thumbnailSize:Ve})})]}),Xe[K]&&K<Xe.length&&(0,d.jsx)(p.kC,{justifyContent:"center",children:(0,d.jsx)(x.zx,{_hover:{textDecoration:"none"},_disabled:{background:"gray.200"},disabled:Xe[K].disabled,px:6,py:2,mb:6,rounded:5,textAlign:"center",bg:"palette.2",color:"white",fontSize:"sm",fontWeight:"bold",onClick:function(){return function(e){var t=K+1;ee(t),re((0,c.Z)(ne).concat([t])),e()}(Xe[K].onClick)},children:Xe[K].text})}),H&&(0,d.jsx)(p.kC,{justifyContent:"center",children:H}),be&&(!P||"processed"!==P.state)&&(0,d.jsxs)(F,{mb:6,children:[(0,d.jsx)(z.qf,{options:nt,width:125,height:125}),P&&"pending"===P.state&&(0,d.jsx)(Y,{step:1,progress:Ze,action:"Uploading"}),P&&"processing"===P.state&&(0,d.jsx)(Y,{step:2,progress:function(e){return e.taskCount&&e.finishedTaskCount?Math.round(e.finishedTaskCount/e.taskCount*100):0}(P),action:"Processing"}),P&&"pending"===P.state&&(0,d.jsx)(p.xv,{fontSize:"sm",children:"Don't close the window during upload!"})]}),P&&"processed"===P.state&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(F,{mb:6,children:(0,d.jsx)(A,{batch:P})}),(0,d.jsxs)(p.kC,{justifyContent:"center",gap:8,children:[(0,d.jsx)(z.Qj,{href:"/batch",inverted:!0,children:"All Downloads"}),(0,d.jsx)(x.zx,{_hover:{textDecoration:"none",bg:Ue?"white":"palette.2",color:Ue?"palette.2":"white"},px:6,py:2,rounded:5,textAlign:"center",bg:"white",color:"palette.2",fontSize:"sm",fontWeight:"bold",borderWidth:"1px",borderColor:"palette.2",onClick:ct,disabled:Ue,children:"Start new Batch"})]})]})]})]})},Re=n(3284),Ae=[{text:"Batch Editor",link:"/batch",styles:{fontWeight:"bold"}}],Ne=function(e){var t,n=e.initialBatches,i=(0,h.useState)(n),a=i[0],s=i[1],o=(0,h.useRef)(!0),l=(0,h.useRef)(new Map),f=(0,h.useState)(),x=f[0],m=f[1],v=(0,g.Sx)({base:!0,md:!1}),b=(0,h.useMemo)((function(){return null!==(t=a.find((function(e){return"processing"===e.state})))&&void 0!==t?t:null}),[a]),j=(0,h.useMemo)((function(){return a.filter((function(e){return("processed"===e.state||"failed"===e.state)&&!e.archivedAt}))}),[a]),w=(0,h.useCallback)((function(e,t){var n;l.current.set(e,t);var r=(n=Math).max.apply(n,(0,c.Z)(Array.from(l.current.values())));m(r)}),[]);return(0,h.useEffect)((function(){return function(){var e=function(){var e=(0,r.Z)(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.t2.get("/api/batches");case 2:t=e.sent,n=t.data.data.batches,o.current&&s(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Re(e,(function(){return!o.current}),2500,1/0)}(),function(){o.current=!1}}),[]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(p.xu,{display:{base:"none",md:"block"},pt:"100px",pl:"40px",children:(0,d.jsx)(ye,{items:Ae})}),(0,d.jsxs)(p.W2,{maxW:"990px",pt:{base:"92px",md:"calc(172px - 115px)"},px:0,mb:8,children:[(0,d.jsxs)(p.kC,{flexDir:"column",alignItems:"center",gap:4,mb:8,children:[(0,d.jsx)(z.Qj,{href:"/batch/new",disabled:Boolean(b),children:"Start new Batch"}),b&&(0,d.jsx)(p.xv,{fontSize:{base:"x-small",md:"xs"},children:"You can start a new batch after the current one is finished."})]}),(0,d.jsxs)(p.kC,{flexDir:"column",gap:8,children:[b&&(0,d.jsxs)(p.kC,{flexDir:"column",gap:2,children:[(0,d.jsxs)(p.kC,{mx:{base:4,lg:0},gap:2,children:[(0,d.jsx)(p.X6,{as:"h3",fontSize:"md",children:"Currently Processing"}),(0,d.jsx)(P.$,{size:"sm",speed:"0.8s",emptyColor:"gray.200",thickness:"2px"})]}),(0,d.jsx)(p.kC,{flexDir:"column",gap:6,children:(0,d.jsx)(R,{batch:b,thumbnailContainerWidth:x,isMobile:null!==v&&void 0!==v&&v,onThumbnailWidthChange:w})})]}),(0,d.jsxs)(p.kC,{flexDir:"column",gap:2,children:[(0,d.jsx)(p.X6,{as:"h3",fontSize:"md",mx:{base:4,lg:0},children:"Finished batches"}),(0,d.jsx)(p.kC,{flexDir:"column",gap:6,children:j.map((function(e){return(0,d.jsx)(R,{batch:e,thumbnailContainerWidth:x,isMobile:null!==v&&void 0!==v&&v,onThumbnailWidthChange:w},e.id)}))}),0===j.length&&(0,d.jsx)(p.xv,{fontSize:"xs",children:"You don't have any batches yet."})]})]})]})]})},Fe=function(){var e,t,n,r=(0,Se.useSession)().data,i=(null===r||void 0===r||null===(e=r.user)||void 0===e||null===(t=e.subscriptions)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.active)||!1,a=(0,h.useState)(!1),s=a[0],o=a[1];return(0,d.jsxs)(p.W2,{maxW:"990px",pt:"172px",children:[(0,d.jsx)(p.kC,{justifyContent:"center",children:(0,d.jsxs)(p.kC,{justifyContent:"center",maxWidth:"620px",wrap:"wrap",children:[(0,d.jsx)(p.kC,{direction:"column",w:{base:"100%",md:"33%"},children:(0,d.jsxs)(p.rj,{pos:"relative",templateColumns:"repeat(6, 1fr)",templateRows:"repeat(6, 1fr)",children:[(0,d.jsx)(p.P4,{zIndex:"1",colStart:1,colEnd:5,rowStart:3,rowEnd:7,children:(0,d.jsx)(m.Ei,{src:"start/automation/original_1.png"})}),(0,d.jsx)(p.P4,{zIndex:"2",colStart:2,colEnd:6,rowStart:2,rowEnd:6,children:(0,d.jsx)(m.Ei,{src:"start/automation/original_2.png"})}),(0,d.jsx)(p.P4,{zIndex:"3",colStart:3,colEnd:7,rowStart:1,rowEnd:5,children:(0,d.jsx)(m.Ei,{src:"start/automation/original_3.png"})})]})}),(0,d.jsxs)(p.rj,{display:{base:"none",md:"grid"},w:"33%",pos:"relative",templateColumns:"repeat(7, 1fr)",templateRows:"repeat(7, 1fr)",children:[(0,d.jsx)(p.P4,{zIndex:"1",colStart:2,colEnd:6,rowStart:5,rowEnd:5,children:(0,d.jsx)(m.Ei,{src:"start/arrow.svg",htmlWidth:"98px"})}),(0,d.jsx)(p.P4,{zIndex:"2",colStart:3,colEnd:7,rowStart:4,rowEnd:4,children:(0,d.jsx)(m.Ei,{src:"start/arrow.svg",htmlWidth:"98px"})}),(0,d.jsx)(p.P4,{zIndex:"3",colStart:4,colEnd:8,rowStart:3,rowEnd:3,children:(0,d.jsx)(m.Ei,{src:"start/arrow.svg",htmlWidth:"98px"})})]}),(0,d.jsx)(p.kC,{direction:"column",w:{base:"100%",md:"33%"},children:(0,d.jsxs)(p.rj,{pos:"relative",templateColumns:"repeat(6, 1fr)",templateRows:"repeat(6, 1fr)",children:[(0,d.jsx)(p.P4,{zIndex:"1",colStart:1,colEnd:5,rowStart:3,rowEnd:7,children:(0,d.jsx)(m.Ei,{src:"start/automation/design_1.png"})}),(0,d.jsx)(p.P4,{zIndex:"2",colStart:2,colEnd:6,rowStart:2,rowEnd:6,children:(0,d.jsx)(m.Ei,{src:"start/automation/design_2.png"})}),(0,d.jsx)(p.P4,{zIndex:"3",colStart:3,colEnd:7,rowStart:1,rowEnd:5,children:(0,d.jsx)(m.Ei,{src:"start/automation/design_3.png"})})]})})]})}),(0,d.jsx)(p.kC,{justifyContent:"center",mt:16,mb:12,children:(0,d.jsx)(p.X6,{as:"h1",maxWidth:"620px",fontSize:64,textAlign:"center",children:"Process any number of images"})}),(0,d.jsx)(p.kC,{justifyContent:"center",mb:12,children:i?(0,d.jsx)(z.Qj,{href:"/batch/new",children:"Start new Batch"}):(0,d.jsx)(x.zx,{_hover:{bg:"palette.2",color:"white"},px:6,py:2,rounded:5,textAlign:"center",bg:"palette.2",color:"white",fontSize:"sm",fontWeight:"bold",borderWidth:"1px",borderColor:"palette.2",onClick:function(){o(!0)},children:"Start new Batch"})}),(0,d.jsx)(z.B8,{open:s,onClose:function(){o(!1)}})]})}},56789:function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var r=n(27378),i=n(1115),a=function(e){null!=e&&"function"!==typeof e&&(0,i.Z)(!1);var t=(0,r.useRef)();(0,r.useEffect)((function(){t.current=function(t){var n=null===e||void 0===e?void 0:e(t);return"string"===typeof n?t.returnValue=n:t.defaultPrevented?t.returnValue="":void 0}}),[e]),(0,r.useEffect)((function(){var e=function(e){return t.current(e)};return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e)}}),[])}}}]);