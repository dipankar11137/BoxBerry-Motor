"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{50268:function(e,n,t){t.d(n,{H:function(){return L}});var i=t(71874),r=t(35230),a=t.n(r),o=t(24246),s=t(27378),l=t(31923),c=t(34896),d=t(43775),h=t(46213),u=t(86677),m=t.n(u),p=t(41716),x=t(71158),g=t(53203),f=t(55021),b=t(68891),j=t(56552),v=t(79894),w=t.n(v),y=t(71592),k=t(79646),S=t(21326),C=t(72172),I=t(97132),z=t(46608),R=function(e){var n,t=function(){L(!1)},r=function(e){e===C.oD.AUTOMATE&&(L(!0),(0,k.q)("automate_from_preview","website_automation"))},d=e.categoryId,h=e.templateId,m=e.imageId,v=e.canvasSize,R=e.mocking,U=e.refetch,E=void 0!==U&&U,_=e.showAsUserTemplate,D=void 0!==_&&_,Z=(0,f.Z)(e,["categoryId","templateId","imageId","canvasSize","mocking","refetch","showAsUserTemplate"]),M=(0,u.useRouter)(),T=(0,y.YD)({triggerOnce:!0}),A=T.ref,H=T.inView,O=(0,C.H4)(),W=(0,s.useState)(!1),N=W[0],F=W[1],P=(0,s.useState)(!1),q=P[0],L=P[1],G=(0,l.Sx)({base:!0,md:!1}),X=(0,s.useCallback)((function(){return b.stringify({tid:h,iid:m},{skipNull:!0})}),[m,h]),V=(0,j.useQuery)(["template",h,m,!0],(0,i.Z)(a().mark((function e(){var n,t,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=b.stringify((n={},(0,x.Z)(n,"image-id",m),(0,x.Z)(n,"res","thumbnail"),n),{skipNull:!0}),e.next=4,O(p.ZP.get("/templates/".concat(h,"?").concat(t)),{skipErrorHandling:function(e,n){return"IMAGE_ID_ERROR"===(null===n||void 0===n?void 0:n.code)}});case 4:return(null===(i=e.sent)||void 0===i?void 0:i.apiErrors)&&"IMAGE_ID_ERROR"===i.apiErrors[0].code&&M.replace("/design-not-found"),e.abrupt("return",i.data.data);case 7:case"end":return e.stop()}}),e)}))),{enabled:!R,refetchOnMount:E}),B=V.isLoading,Q=V.data,Y=(0,s.useRef)(null),$=(0,s.useRef)(null),J=(0,s.useRef)(null),K=(0,s.useMemo)((function(){return[C.oD.AUTOMATE]}),[]),ee=(0,C.qP)({template:Q,imageId:m,templateElem:null!==(n=null===J||void 0===J?void 0:J.current)&&void 0!==n?n:void 0,canvasSize:v,renameModalRef:Y,deleteModalRef:$,mock:K});return(0,o.jsx)(w(),{passHref:!N,href:R?"":D?"/templates/".concat(h).concat(m?"?iid="+m:""):d?"/categories/".concat(d,"?").concat(X()):"",children:(0,o.jsxs)(c.rU,{_hover:{textDecoration:"none"},onClick:function(){(0,k.q)("select_design","image",!1)},mr:4,mb:4,children:[(0,o.jsx)(I.M2,{condition:!G&&!m&&Q,wrapper:function(e){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(I.tt,{ref:Y,template:Q}),(0,o.jsx)(I.pf,{ref:$,template:Q}),(0,o.jsx)(I.rA,{template:Q,open:q,onClose:t}),(0,o.jsx)(I.xV,{elements:ee,onOpenChange:function(e){return F(e)},onActionComplete:r,children:e})]})},children:(0,o.jsx)(S.Z,(0,g.Z)({ref:J,containerRef:A,transition:"box-shadow .1s linear",loading:B||R,template:Q,canvasSize:v,shouldRender:H},Z))}),(0,o.jsx)(c.xv,{noOfLines:1,width:(0,z.Z)(v).width,height:{base:"14px",lg:"16px"},fontSize:{base:"xx-small",lg:"xs"},color:"gray.500",children:Q&&Q.name})]})})},U=t(24037),E=t(29549),_=(0,s.forwardRef)((function(e,n){var t=e.icon,i=e.text,r=e.previewThumbnailUrl,a=e.children,s=(0,f.Z)(e,["icon","text","previewThumbnailUrl","children"]);return(0,o.jsxs)(E.zx,(0,U.Z)((0,g.Z)({ref:n,display:"flex",flexDir:"column",p:1,"aria-label":i,fontSize:"2rem",variant:"unstyled",borderWidth:"1px",borderStyle:"solid",borderColor:"palette.2",borderRadius:0,whiteSpace:"normal",color:"palette.2",_hover:{bgColor:"palette.2",color:"white"}},s),{children:[r?(0,o.jsx)(h.Ei,{maxWidth:"50%",maxHeight:"30%",alt:"",src:r,mb:2}):t,(0,o.jsx)(c.xv,{fontSize:{base:"xs",md:"sm"},children:i}),a]}))})),D=t(77934),Z=t(388),M=t(10043),T=t(59389);function A(){var e=(0,Z.Z)(["\n    0% {\n        transform: scale3d(1.0);\n        opacity: 1;\n    }\n    25% {\n        transform: scale3d(0.5);\n        opacity: 0;\n    }\n    50% {\n        transform: scale3d(1.0);\n        opacity: 1;\n    }\n    75% {\n        transform: scale3d(0.5);\n        opacity: 0;\n    }\n    100% {\n        -webkit-transform: scale3d(1.0);\n        opacity: 1;\n    }\n"]);return A=function(){return e},e}function H(){for(var e=50;40<e&&e<60||e>95;)e=100*Math.random();return e}var O=(0,M.F4)(A()),W=(0,T.m$)(h.Ee,{baseStyle:{position:"absolute",width:"15px",height:"15px",opacity:0,animation:"".concat(O," 2s linear 0s infinite normal")}}),N=function(e){var n=(0,D.Z)({},e);return(0,o.jsx)(c.xu,(0,U.Z)((0,g.Z)({position:"absolute"},n),{children:Array.from({length:25}).map((function(e,n){return(0,o.jsx)(W,{src:"/glitter.svg",top:H()+"%",left:H()+"%",style:{animationDelay:.5+Math.random()+"s"}},n)}))}))},F=t(60597),P=t(73868),q=t(49419),L=function(e){var n=e.mocking,t=void 0!==n&&n,r=e.imageId,u=e.categories,x=e.previewImage,g=e.userTemplates,f=function(e){return j?{width:j.width*e.aspectRatio,height:j.height}:{width:100,height:100}},j=(0,l.Sx)({base:{width:100,height:100},md:{width:120,height:120},lg:{width:135,height:135}}),v=(0,s.useState)(),y=v[0],S=v[1],I=(0,C.H4)(),z=(0,P.useSession)().data,U=(0,l.Sx)({base:"2rem",md:"2.5rem",lg:"3rem"}),E=(0,s.useMemo)((function(){return b.stringifyUrl({url:"/templates/new",query:{iid:r}})}),[r]);return(0,s.useEffect)((function(){function e(){return e=(0,i.Z)(a().mark((function e(){var n,t,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(p.ZP.get("/images/".concat(r)),{skipErrorHandling:function(e){var n;return 404===(null===(n=e.response)||void 0===n?void 0:n.status)}});case 2:n=e.sent,t=n.data,404===n.status?m().replace("/design-not-found"):t.data&&(i=t.data,S(i.backgroundRemovedThumbnailUrl?i.backgroundRemovedThumbnailUrl:i.originalThumbnailUrl));case 6:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!t&&r?function(){e.apply(this,arguments)}():S(void 0)}),[t,r,I]),(0,o.jsxs)(c.kC,{flexDirection:"column",pt:t||r?"60px":"80px",minHeight:"100%",width:"100%",children:[(t||r)&&(0,o.jsxs)(c.xu,{backgroundColor:"white",pb:3,px:6,mb:3,children:[(0,o.jsx)(c.kC,{"data-hj-suppress":"true",justifyContent:"center",alignItems:"center",pt:10,pb:8,children:(0,o.jsx)(d.Od,{isLoaded:Boolean(!t&&y||t&&x),display:"flex",justifyContent:"center",alignItems:"center",width:{base:"100%",lg:300},height:{base:200,lg:300},children:t?(0,o.jsxs)(c.xu,{position:"relative",display:"inline-block",children:[(0,o.jsx)(N,{width:"100%",height:"100%"}),(0,o.jsx)(h.Ee,{maxWidth:{base:"100%",lg:300},maxHeight:{base:200,lg:300},alt:"",src:x})]}):(0,o.jsx)(h.Ei,{alt:"",maxWidth:{base:"100%",lg:300},maxHeight:{base:200,lg:300},src:y})})}),(0,o.jsx)(c.xv,{fontSize:{base:"2xl",lg:"3xl"},fontFamily:"Poppins",fontWeight:"700",color:"gray.900",children:t?"Generating designs...":"Select design"})]}),j?(0,o.jsxs)(c.xu,{flex:"1",pb:8,children:[z&&g&&g.length>0&&(0,o.jsxs)(c.xu,{mb:4,children:[(0,o.jsx)(c.xu,{mb:4,mx:6,children:(0,o.jsx)(c.X6,{as:"h3",fontFamily:"Poppins",fontWeight:"700",fontSize:"md",color:"gray.900",children:"My Designs"})}),(0,o.jsxs)(c.kC,{wrap:"wrap",pl:6,children:[g.map((function(e){return(0,o.jsx)(R,{mocking:!1,refetch:!0,showAsUserTemplate:!0,categoryId:e.categoryId,templateId:e.id,name:e.name,imageId:r,canvasSize:f(e)},e.id)})),(0,o.jsx)(w(),{passHref:!0,href:E,children:(0,o.jsx)(c.rU,{_hover:{textDecoration:"none"},children:(0,o.jsx)(_,{text:"New Design",icon:(0,o.jsx)(F.OvN,{size:U}),previewThumbnailUrl:y,width:j.width,height:j.height})})})]})]}),u.map((function(e){return(0,o.jsxs)(c.xu,{mb:4,children:[(0,o.jsx)(c.xu,{mb:2,mx:6,children:"loadingMockCategory"===e.name?(0,o.jsx)(d.Od,{isLoaded:!1,width:"140px",height:"20px",mb:3}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c.X6,{as:"h3",fontFamily:"Poppins",fontWeight:"700",fontSize:"md",color:"gray.900",children:e.name}),!r&&e.description&&(0,o.jsx)(c.xv,{fontSize:"xs",color:"gray.500",mt:1,mb:3,children:e.description})]})}),(0,o.jsx)(c.kC,{wrap:"wrap",pl:6,children:e.templates&&e.templates.map((function(n){return(0,o.jsx)(R,{mocking:"loadingMockTemplate"===n.name,categoryId:e.id,templateId:n.id,name:n.name,imageId:r,canvasSize:f(n)},n.id)}))})]},e.id)})),g&&0===g.length&&(0,o.jsxs)(c.xu,{mb:4,children:[(0,o.jsx)(c.xu,{mb:4,mx:6,children:(0,o.jsx)(c.X6,{as:"h3",fontFamily:"Poppins",fontWeight:"700",fontSize:"md",color:"gray.900",children:"My Designs"})}),(0,o.jsxs)(c.kC,{wrap:"wrap",pl:6,children:[!z&&(0,o.jsx)(c.kC,{width:1.5*j.width+16,height:j.height,bgColor:"white",mr:4,mb:4,alignItems:"center",borderColor:"gray.300",borderWidth:"1px",borderStyle:"solid",children:(0,o.jsxs)(c.xu,{height:"min-content",mx:{base:8,md:10,lg:12},textAlign:"center",fontSize:{base:"xs",md:"sm"},children:[(0,o.jsx)(c.rU,{_hover:{textDecoration:"none"},color:"palette.2",onClick:function(){(0,k.q)("signup","user",!1),(0,q.z)("kaleido")},children:"Login"})," ","or"," ",(0,o.jsx)(c.rU,{_hover:{textDecoration:"none"},color:"palette.2",onClick:function(){(0,k.q)("signup","user",!1),(0,q.z)("kaleido",null,{form:"signup"})},children:"Sign Up"})," ","to save designs"]})}),(0,o.jsx)(w(),{passHref:!0,href:E,children:(0,o.jsx)(c.rU,{_hover:{textDecoration:"none"},children:(0,o.jsx)(_,{text:"New Design",icon:(0,o.jsx)(F.OvN,{size:U}),previewThumbnailUrl:y,width:j.width,height:j.height})})})]})]})]}):(0,o.jsx)(c.xu,{minHeight:"600px"})]})}}}]);